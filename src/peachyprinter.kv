#:kivy 1.8.0
#:import _ __main__._
#Limport FloatInput ui.custom_widgets.FloatInput


<MyScreenManager>:

<SettingsSelector>:
    size_hint: [0.6, 0.6]
    title: _('Settings Selection')
    BoxLayout:
        orientation: 'vertical'
        Button:
            text: _('Laser Calibration')
            #on_release: app.open_settings()
        Button:
            text: _('Dripper Calibration')
            on_release: root.dismiss(); app.root.current = 'drippercalibrationui'
        Button:
            text: _('Resin Curing Calibration')
            on_release: root.dismiss(); app.root.current = 'curetestui'
        Button:
            text: _('Advanced Settings')
            on_release: app.open_settings()
        Button:
            text: _('Close')
            on_release: root.dismiss()

<MainUI>:
    name: 'mainui'
    id: mainui
    FloatLayout:
        BoxLayout:
            size: root.size
            pos: root.pos
            orientation: 'horizontal'
            BoxLayout:
                size_hint: [0.3, 1.0]
                orientation: 'vertical'
                Button:
                    text: 'Print from file'
                    on_release: mainui.show_load()
                Button:
                    text: 'Print from library'
                    on_release: app.root.current = 'libraryui'
            Image:
                source: 'resources/logo.png'
                allow_stretch: True
                keep_ratio: True
        FloatLayout:
            Button:
                size_hint: [0.06, 0.06]
                pos: [root.size[0] - root.size[0] * 0.06, root.size[1] - root.size[1] * 0.06 ]
                on_release: root.setting_selected()
                background_normal: 'resources/icons/settings-up.png'
                background_down:   'resources/icons/settings-down.png'

<PrintPop>:
    size_hint: [0.9, 0.9]
    BoxLayout:
        orientation: 'horizontal'
        Image:
            size_hint: (0.8,1.0)
            source: root.image()
        BoxLayout:
            orientation: 'vertical'
            StackLayout:
                orientation: 'lr-tb'
                BoxLayout:
                    size_hint: [1.0, 40 / root.height]
                    orientation: 'horizontal'
                    Label:
                        text: _("Height (mm)")
                    FloatInput:
                        text: '20'
                BoxLayout:
                    size_hint: [1.0, 40 / root.height]
                    orientation: 'horizontal'
                    Label:
                        text: _("Width (mm)")
                    FloatInput:
                        text: '20'
                BoxLayout:
                    size_hint: [1.0, 40 / root.height]
                    orientation: 'horizontal'
                    Label:
                        text: _("Layer Height (mm)")
                    FloatInput:
                        text: '0.01'
                BoxLayout:
                    size_hint: [1.0, 40 / root.height]
                    orientation: 'horizontal'
                    Label:
                        text: _("Speed (mm/sec)")
                    FloatInput:
                        text: '120'
            BoxLayout:
                size_hint: [1.0, 40 / root.height]
                orientation: 'horizontal'
                Button:
                    text: _("Cancel")
                    on_release: root.dismiss()
                Button:
                    text: _("Print Now")

<DripperCalibrationUI>:
    name: 'drippercalibrationui'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'Dripper Type'
                Spinner:
                    values: [_("Peachy Printer"), _("Emulated Dripper")]
            Button:
                text: _("Start Count Drips")
            Button:
                text: _("Stop Counting Drips")
            Button:
                text: _("Reset Drip Count")
            Button:
                text:"Back"
                on_release: app.root.current = 'mainui'
        BoxLayout:
            orientation: 'vertical'
            Label:
                text: _('Drips Calculator')
            GridLayout:
                cols: 2
                Label:
                    text: _("Start Height (mm)")
                FloatInput:
                    text: '0'
                Label:
                    text: _("End Height (mm)")
                FloatInput:
                    text: '100'
                Label:
                    text: _("Total Height (mm)")
                FloatInput:
                    text: '0'
                    disabled: True
                Label:
                    text: _('Drips')
                FloatInput:
                    text: '100'
                Label:
                    text: _('Drips per mm')
                FloatInput:
                    text: '1'
                Label:
                    text: ''
                Button:
                    text: _("Save")

        Label:
            text: 'Drip Visualizatin Here'



<LibraryUI>:
    name: 'libraryui'
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            GridLayout:
                id: library_grid
                cols: 2
        Button:
            size_hint: [1.0, 0.05]
            text: _('Back')
            on_release: app.root.current = 'mainui'

<PrintingUI>:
    name: 'printingui'
    BoxLayout:
        Accordion:
            orientation: 'vertical'
            size_hint_x:0.6
            AccordionItem:
                collapse:False
                id: print_details
                title: _('Print Details')
                ScrollView:
                    PrintStatus:
                        id: print_status
                        cols: 1
                        size_hint_y:None
                        text_padding_x: 10
            AccordionItem:
                title: _('Printer Settings')
                collapse:True
                ScrollView:
                    LabelGridLayout:
                        id: print_settings
                        size_hint_y:None
                        text_padding_x: 10
                        cols: 1
        BoxLayout:
            id: displaywindow
            Label:
                text: 'Printing UI'
            Button:
                text: 'Abort'
                size_hint:[0.2,0.1]
                on_release: app.root.current = 'mainui'
            Dripper:
                id: dripper
                size_hint_x: 0.05

<Dripper>:

<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: 'vertical'
        FileChooserListView:
            id: filechooser
            filters: ['*.gcode']
            path: u'~'

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: 'Cancel'
                on_release: root.cancel()

            Button:
                text: 'Load'
                on_release: root.load(filechooser.path, filechooser.selection)


<CureTestUI>:
    name: 'curetestui'
    BoxLayout:
        orientation: 'horizontal'
        Button:
            text: _('Back')
            on_release: app.root.current = 'mainui'
        GridLayout:
            cols: 2
            Label:
                text: _('Height (mm)')
            FloatInput:
                text: '40'
            Label:
                text: _('Width (mm)')
            FloatInput:
                text: '10'
            Label:
                text: _("Start Speed")
            FloatInput:
                text: '90'
            Label:
                text: _("Finish Speed")
            FloatInput:
                text: '250'
        Button:
            text: _("Start Test")