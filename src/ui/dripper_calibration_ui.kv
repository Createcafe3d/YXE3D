#:kivy 1.8.0
#:import _ __main__._
#:import FloatInput ui.custom_widgets.FloatInput

<I18NKeyedSpinner>:
    #text: app.translation(self.text_source)
    values: [app.translation(value) for value in self.values_source]

<DripperCalibrationUI>:
    name: 'drippercalibrationui'
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    size_hint_y: None
                    height: 30
                    orientation: 'horizontal'
                    I18NLabel:
                        text_source: _('Dripper Type')
                    I18NKeyedSpinner:
                        id: dripper_type_selector
                        values_source: [_('Emulated'), _('Photo'), _('Circut')]
                        keys: ['emulated', 'photo', 'microcontroller']
                        #text_source: _("Circut")
                        key:  'microcontroller'
                        on_key: root.dripper_type_changed(self, self.key)
                BoxLayout:
                    id: dripper_setup
                I18NButton:
                    text_source: _("Help me")
                    on_release: HelpPopup(text=_('MARKUP - Dripper Instructions'), title=_("Help - Dripper Settings"), size_hint=(0.9, 0.9)).open()
                    size_hint_y:None
                    height: 30
            BoxLayout:
                id: visualizations
        I18NButton:
            text_source: _("Back")
            size_hint_y: None
            height: 30
            on_release: app.root.current = 'mainui'

<EmulatedDripSetup>:
    orientation: 'vertical'
    BoxLayout:
        size_hint_y: 40.0 / root.height
        I18NLabel:
            text_source: _("Drips Per Second")
        FloatInput:
            text: str(root.drips_per_second)
            on_text: root.drips_per_second = float(self.text)
    BoxLayout:
        size_hint_y: 40.0 / root.height
        I18NLabel:
            text_source: _("Drips Per Millimeter")
        FloatInput:
            text: str(root.drips_per_mm)
            on_text: root.drips_per_mm = float(self.text)
    Label:

<PhotoDripSetup>:
    orientation: 'vertical'
    BoxLayout:
        size_hint_y: 40.0 / root.height
        I18NLabel:
            text_source: _("Delay After Layer")
        FloatInput:
            text: str(root.photo_zaxis_delay)
            on_text: root.photo_zaxis_delay = float(self.text)
    Label:

<MicrocontrollerDripSetup>:
    orientation: 'vertical'
    ScrollView:
        BoxLayout:
            size_hint_y: None
            height: 250
            orientation: 'vertical'
            padding: 10
            canvas.before:
                Color:
                    rgba:[0.2,0.2,0.2,1.0]
                Rectangle:
                    size: [self.size[0] - 20, self.size[1] - 20]
                    pos: [self.pos[0] + 10, self.pos[1] + 10]
            I18NLabel:
                size_hint_y: None
                height: 30
                text_source: _("Drip Calculator")
            Label:
                size_hint_y: None
                height: 10
            BoxLayout:
                size_hint_y: None
                height: 30
                orientation: 'horizontal'
                Label:
                    text_source: _("Distance to Measure (mm)")
                FloatInput:
                    text: '%.2f' % root.total_height
            Label:
                size_hint_y: None
                height: 10
            Button:
                size_hint_y: None
                height: 30
                text_source: _("Reset Drip Count")
                on_release: root.reset_drip_count()
            BoxLayout:
                size_hint_y: None
                height: 30
                orientation: 'horizontal'
                I18NLabel:
                    text_source: _('Drips')
                Label:
                    text: '%.2f' % root.drips
            BoxLayout:
                size_hint_y: None
                height: 30
                orientation: 'horizontal'
                I18NLabel:
                    text_source: _('Average Drips per Second')
                Label:
                    text: '%.2f' % root.average_drips
            BoxLayout:
                size_hint_y: None
                height: 30
                orientation: 'horizontal'
                Label:
                    text_source: _('Current Drips per mm')
                Label:
                    text: '%.2f' % root.current_drips_per_mm
            I18NButton:
                size_hint_y: None
                height: 30
                text_source: _("Use Current Drips per mm")
                on_release: root.use_current()
    Label:
        size_hint_y: None
        height: 10
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 30
        I18NLabel:
            text_source: _('Drips per mm')
        FloatInput:
            id: ui_drips_per_mm
            text: '0.0'
            on_text: root.drips_per_mm = float(self.text)
    Label:
        size_hint_y: None
        height: 10        
